/home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  np.bool: ctypes.c_bool}
/opt/software/python/anaconda/2021_11/lib/python3.9/site-packages/flatbuffers/compat.py:19: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
wandb: Currently logged in as: green-of-tim (use `wandb login --relogin` to force relogin)
wandb: Tracking run with wandb version 0.12.13
wandb: Run data is saved locally in /home/tgrinev/jax_muzero/wandb/run-20220426_182748-2d00e2hc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run winter-sky-23
wandb: ‚≠êÔ∏è View project at https://wandb.ai/green-of-tim/MuZero
wandb: üöÄ View run at https://wandb.ai/green-of-tim/MuZero/runs/2d00e2hc
[34m[1mwandb[0m: [33mWARNING[0m Found log directory outside of given root_logdir, dropping given root_logdir for event file in /home/tgrinev/ray_results/minigrid_bern_bern/Experiment_Minigrid_79550_00000_0_2022-04-26_18-28-08
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /opt/software/python/anaconda/2021_11/lib/python3.9/site-packages/flatbuffers/compat.py:19: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
[2m[36m(pid=47716)[0m   import imp
[2m[36m(pid=47716)[0m WARNING:absl:No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
[2m[36m(pid=47716)[0m WARNING:root:Running on 1 cpu(s)
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/dummy_vec_env.py:26: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   self.buf_dones = np.zeros((self.num_envs,), dtype=np.bool)
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/vec_frame_stack.py:15: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   self.news = np.zeros((venv.num_envs,), dtype=np.bool)
[2m[36m(pid=47716)[0m WARNING:root:Creating dummy env object to get spaces
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:58: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   raw_done_buf = alloc_shmem(ctx, (len(env_fns),), np.bool)
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/jax_muzero/vec_env/shmem_vec_env.py:18: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
[2m[36m(pid=47716)[0m Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
[2m[36m(pid=47716)[0m   np.bool: ctypes.c_bool}
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m /home/tgrinev/.local/lib/python3.9/site-packages/gym/utils/seeding.py:47: DeprecationWarning: [33mWARN: Function `rng.randint(low, [high, size, dtype])` is marked as deprecated and will be removed in the future. Please use `rng.integers(low, [high, size, dtype])` instead.[0m
[2m[36m(pid=47716)[0m   deprecation(
[2m[36m(pid=47716)[0m 2022-04-26 18:28:24,075	INFO trainable.py:110 -- Trainable.setup took 10.375 seconds. If your trainable is slow to initialize, consider setting reuse_actors=True to reduce actor creation overheads.
2022-04-26 18:28:25,912	ERROR trial_runner.py:924 -- Trial Experiment_Minigrid_79550_00000: Error processing event.
Traceback (most recent call last):
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/tune/trial_runner.py", line 890, in _process_trial
    results = self.trial_executor.fetch_result(trial)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/tune/ray_trial_executor.py", line 788, in fetch_result
    result = ray.get(trial_future[0], timeout=DEFAULT_GET_TIMEOUT)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 105, in wrapper
    return func(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/worker.py", line 1625, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TypeError): [36mray::Experiment_Minigrid.train_buffered()[39m (pid=47716, ip=192.168.1.12, repr=<algorithms.muzero.Experiment_Minigrid object at 0x7f51bfeffbb0>)
TypeError: 'float' object cannot be interpreted as an integer

During handling of the above exception, another exception occurred:

[36mray::Experiment_Minigrid.train_buffered()[39m (pid=47716, ip=192.168.1.12, repr=<algorithms.muzero.Experiment_Minigrid object at 0x7f51bfeffbb0>)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/workers/default_worker.py", line 218, in <module>
    ray.worker.global_worker.main_loop()
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/tune/trainable.py", line 224, in train_buffered
    result = self.train()
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/tune/trainable.py", line 283, in train
    result = self.step()
  File "/home/tgrinev/jax_muzero/algorithms/muzero.py", line 589, in step
    self._params, self._opt_state, log = self._update_fn(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/api.py", line 2013, in cache_miss
    out_tree, out_flat = f_pmapped_(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/api.py", line 1889, in pmap_f
    out = pxla.xla_pmap(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/core.py", line 1863, in bind
    return map_bind(self, fun, *args, **params)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/core.py", line 1895, in map_bind
    outs = primitive.process(top_trace, fun, tracers, params)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/core.py", line 1866, in process
    return trace.process_map(self, fun, tracers, params)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/core.py", line 660, in process_call
    return primitive.impl(f, *tracers, **params)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/pxla.py", line 801, in xla_pmap_impl
    compiled_fun, fingerprint = parallel_callable(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/linear_util.py", line 285, in memoized_fun
    ans = call(fun, *args)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/pxla.py", line 829, in parallel_callable
    pmap_computation = lower_parallel_callable(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/profiler.py", line 206, in wrapper
    return func(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/pxla.py", line 1002, in lower_parallel_callable
    jaxpr, consts, replicas, parts, shards = stage_parallel_callable(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/pxla.py", line 909, in stage_parallel_callable
    jaxpr, out_sharded_avals, consts = pe.trace_to_jaxpr_final(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/profiler.py", line 206, in wrapper
    return func(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1844, in trace_to_jaxpr_final
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1816, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/tgrinev/jax_muzero/algorithms/muzero.py", line 168, in update
    grads, log = jax.grad(batch_loss, has_aux=True)(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/api.py", line 912, in grad_f_aux
    (_, aux), g = value_and_grad_f(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/api.py", line 984, in value_and_grad_f
    ans, vjp_py, aux = _vjp(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/api.py", line 2446, in _vjp
    out_primal, out_vjp, aux = ad.vjp(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/ad.py", line 131, in vjp
    out_primals, pvals, jaxpr, consts, aux = linearize(traceable, *primals, has_aux=True)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/ad.py", line 116, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr(jvpfun_flat, in_pvals)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/profiler.py", line 206, in wrapper
    return func(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 606, in trace_to_jaxpr
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/tgrinev/jax_muzero/algorithms/muzero.py", line 143, in batch_loss
    losses, log = jax.vmap(loss, (None, None, 0, 0))(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/api.py", line 1472, in vmap_f
    out_flat = batching.batch(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/tgrinev/jax_muzero/algorithms/muzero.py", line 69, in loss
    target_trees = jax.vmap(agent.mcts, (0, None, 0, None))(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/api.py", line 1472, in vmap_f
    out_flat = batching.batch(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/tgrinev/jax_muzero/algorithms/agents.py", line 347, in mcts
    rng_key, tree = jax.lax.fori_loop(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/lax/control_flow.py", line 225, in fori_loop
    (_, result), _ = scan(_fori_scan_body_fun(body_fun), (lower_, init_val),
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/lax/control_flow.py", line 1542, in scan
    init_flat, carry_avals, carry_avals_out, init_tree, *rest = _create_jaxpr(init)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/lax/control_flow.py", line 1528, in _create_jaxpr
    jaxpr, consts, out_tree = _initial_style_jaxpr(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/util.py", line 219, in wrapper
    return cached(config._trace_context(), *args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/util.py", line 212, in cached
    return f(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/lax/control_flow.py", line 83, in _initial_style_jaxpr
    jaxpr, consts, out_tree = _initial_style_open_jaxpr(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/util.py", line 219, in wrapper
    return cached(config._trace_context(), *args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/util.py", line 212, in cached
    return f(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/lax/control_flow.py", line 77, in _initial_style_open_jaxpr
    jaxpr, _, consts = pe.trace_to_jaxpr_dynamic(wrapped_fun, in_avals, debug)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/profiler.py", line 206, in wrapper
    return func(*args, **kwargs)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1779, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1816, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/lax/control_flow.py", line 150, in scanned_fun
    return (i + 1, body_fun(i, x)), None
  File "/home/tgrinev/jax_muzero/algorithms/agents.py", line 339, in body_fn
    p, a = simulate(simulate_key, tree)
  File "/home/tgrinev/jax_muzero/algorithms/agents.py", line 287, in simulate
    a = _select_action(sub_key, 0, q_mean, w_mean)
  File "/home/tgrinev/jax_muzero/algorithms/agents.py", line 228, in _select_action
    w = jnp.max(action_value[t] ** 2, 1e-2)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 194, in max
    return _reduce_max(a, axis=_ensure_optional_axes(axis), out=out,
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 150, in _ensure_optional_axes
    return core.concrete_or_error(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/core.py", line 1136, in concrete_or_error
    return force(val)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 149, in force
    return tuple(i if isinstance(i, str) else operator.index(i) for i in x)
jax._src.traceback_util.UnfilteredStackTrace: TypeError: 'float' object is not iterable

The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.

--------------------

The above exception was the direct cause of the following exception:

[36mray::Experiment_Minigrid.train_buffered()[39m (pid=47716, ip=192.168.1.12, repr=<algorithms.muzero.Experiment_Minigrid object at 0x7f51bfeffbb0>)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/tune/trainable.py", line 224, in train_buffered
    result = self.train()
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/tune/trainable.py", line 283, in train
    result = self.step()
  File "/home/tgrinev/jax_muzero/algorithms/muzero.py", line 589, in step
    self._params, self._opt_state, log = self._update_fn(
  File "/home/tgrinev/jax_muzero/algorithms/muzero.py", line 168, in update
    grads, log = jax.grad(batch_loss, has_aux=True)(
  File "/home/tgrinev/jax_muzero/algorithms/muzero.py", line 143, in batch_loss
    losses, log = jax.vmap(loss, (None, None, 0, 0))(
  File "/home/tgrinev/jax_muzero/algorithms/muzero.py", line 69, in loss
    target_trees = jax.vmap(agent.mcts, (0, None, 0, None))(
  File "/home/tgrinev/jax_muzero/algorithms/agents.py", line 347, in mcts
    rng_key, tree = jax.lax.fori_loop(
  File "/home/tgrinev/jax_muzero/algorithms/agents.py", line 339, in body_fn
    p, a = simulate(simulate_key, tree)
  File "/home/tgrinev/jax_muzero/algorithms/agents.py", line 287, in simulate
    a = _select_action(sub_key, 0, q_mean, w_mean)
  File "/home/tgrinev/jax_muzero/algorithms/agents.py", line 228, in _select_action
    w = jnp.max(action_value[t] ** 2, 1e-2)
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 194, in max
    return _reduce_max(a, axis=_ensure_optional_axes(axis), out=out,
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 150, in _ensure_optional_axes
    return core.concrete_or_error(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/jax/_src/numpy/reductions.py", line 149, in force
    return tuple(i if isinstance(i, str) else operator.index(i) for i in x)
TypeError: 'float' object is not iterable
[2m[36m(pid=47716)[0m [2022-04-26 18:28:26,703 E 47716 48614] raylet_client.cc:159: IOError: Broken pipe [RayletClient] Failed to disconnect from raylet.
Traceback (most recent call last):
  File "/home/tgrinev/jax_muzero/minigrid_bern.py", line 57, in <module>
    analysis = tune.run(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/tune/tune.py", line 624, in run
    raise TuneError("Trials did not complete", incomplete_trials)
ray.tune.error.TuneError: ('Trials did not complete', [Experiment_Minigrid_79550_00000])
Traceback (most recent call last):
  File "/home/tgrinev/jax_muzero/minigrid_bern.py", line 57, in <module>
    analysis = tune.run(
  File "/home/tgrinev/.local/lib/python3.9/site-packages/ray/tune/tune.py", line 624, in run
    raise TuneError("Trials did not complete", incomplete_trials)
ray.tune.error.TuneError: ('Trials did not complete', [Experiment_Minigrid_79550_00000])
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.001 MB of 0.001 MB uploaded (0.000 MB deduped)wandb: \ 0.001 MB of 0.001 MB uploaded (0.000 MB deduped)wandb: | 0.001 MB of 0.001 MB uploaded (0.000 MB deduped)wandb: / 0.001 MB of 0.001 MB uploaded (0.000 MB deduped)wandb: - 0.001 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: \ 0.001 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: | 0.001 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: / 0.067 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: - 0.067 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: \ 0.067 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: | 0.067 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: / 0.067 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: - 0.067 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: \ 0.067 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: | 0.067 MB of 0.067 MB uploaded (0.000 MB deduped)wandb: / 0.067 MB of 0.067 MB uploaded (0.000 MB deduped)wandb:                                                                                
wandb: Synced winter-sky-23: https://wandb.ai/green-of-tim/MuZero/runs/2d00e2hc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 1 other file(s)
wandb: Find logs at: ./wandb/run-20220426_182748-2d00e2hc/logs
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
2022-04-27 11:46:01,331	WARNING ray_trial_executor.py:768 -- Over the last 60 seconds, the Tune event loop has been backlogged processing new results. Consider increasing your period of result reporting to improve performance.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
2022-04-27 12:49:34,411	WARNING ray_trial_executor.py:768 -- Over the last 60 seconds, the Tune event loop has been backlogged processing new results. Consider increasing your period of result reporting to improve performance.
2022-04-27 14:06:18,734	WARNING ray_trial_executor.py:768 -- Over the last 60 seconds, the Tune event loop has been backlogged processing new results. Consider increasing your period of result reporting to improve performance.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
2022-04-27 15:20:27,260	WARNING ray_trial_executor.py:768 -- Over the last 60 seconds, the Tune event loop has been backlogged processing new results. Consider increasing your period of result reporting to improve performance.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
2022-04-27 18:06:06,140	WARNING trial_runner.py:714 -- Trial Runner checkpointing failed: [Errno 2] No such file or directory: '/home/tgrinev/ray_results/minigrid_bern_bern/.tmp_checkpoint' -> '/home/tgrinev/ray_results/minigrid_bern_bern/experiment_state-2022-04-25_18-31-57.json'
slurmstepd: error: *** JOB 565957 ON cn-018 CANCELLED AT 2022-04-27T18:31:07 DUE TO TIME LIMIT ***
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: ERROR Error while calling W&B API: Error 1040: Too many connections (<Response [500]>)
wandb: Network error (ReadTimeout), entering retry loop.
2022-04-28 03:01:50,078	WARNING ray_trial_executor.py:768 -- Over the last 60 seconds, the Tune event loop has been backlogged processing new results. Consider increasing your period of result reporting to improve performance.
wandb: Network error (ReadTimeout), entering retry loop.
wandb: Network error (ReadTimeout), entering retry loop.
2022-04-28 09:03:38,214	WARNING util.py:165 -- The `callbacks.on_trial_result` operation took 4.332 s, which may be a performance bottleneck.
2022-04-28 09:03:38,220	WARNING util.py:165 -- The `process_trial_result` operation took 4.338 s, which may be a performance bottleneck.
2022-04-28 09:03:38,235	WARNING util.py:165 -- Processing trial results took 4.353 s, which may be a performance bottleneck. Please consider reporting results less frequently to Ray Tune.
2022-04-28 09:03:38,252	WARNING util.py:165 -- The `process_trial` operation took 4.375 s, which may be a performance bottleneck.
wandb: Network error (ReadTimeout), entering retry loop.
slurmstepd: error: *** JOB 567542 ON cn-020 CANCELLED AT 2022-04-28T10:26:58 DUE TO TIME LIMIT ***
